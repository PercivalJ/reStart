<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

<h1>Start A Conversation</h1>

<div>

    <div class="form-group">
      
      <label for="Group">Group</label>
      
      <input class="form-control" type="text" name="group" id="group">

    </div>

    <div class="form-group">
      
      <label for="Topic">Topic</label>

      <input class="form-control topics" type="text" name="topic" id="topic">

    </div>
    
    <div class="form-group">
      
      <label for="Topic">Topic</label>

      <input class="form-control topics" type="text" name="topic" id="topic">

    </div>
    
    <div class="form-group">
      
      <label for="Topic">Topic</label>

      <input class="form-control topics" type="text" name="topic" id="topic">

    </div>
    
    <div class="form-group">
      
      <label for="Topic">Topic</label>

      <input class="form-control topics" type="text" name="topic" id="topic">

    </div>
    
    <div class="form-group">
      
      <label for="Topic">Topic</label>

      <input class="form-control topics" type="text" name="topic" id="topic">

    </div>

    <div class="form-topic">

      <label for="Location">Location</label>

      <input class="form-control" type="text" name="location" id="location">

    </div>

    <input class="btn btn-default myBtn" type="submit" value="Submit">

</div>

<a href="/">Home</a>


<script>
    var getLoc;
    $(window).ready( function() {
        navigator.geolocation.getCurrentPosition( function( position ) { 
            getLoc = position
            console.log( getLoc)
        } )
        
        $(".myBtn").click(function( e ) {
       //e.preventDefault()
       console.log( getLoc )
       var topics = $(".topics")
       var group = $(".group").val()
       var location = $("#location" ).val()
       var topicConvos = []
       for ( var i = 0; i < topics; i++ ) {
           if ( topics[ i ].value ) {
               topicConvos.push( topic[ i ].value )
           }
       }
       var dataObject = {
           funtime: "Hello",
           topic: topicConvos,
           group:  group,
           location: location,
           latitude: getLoc.coords.latitude,
           longitude: getLoc.coords.longitude
       }
       console.log( "Stuff")
    $.ajax( { 
           url: '/api/conversations',
           type: 'POST',
           cache: false, 
           data: dataObject, 
           success: function(data){
              window.location = "/"
           }
           , error: function(jqXHR, textStatus, err){
               alert('text status '+textStatus+', err '+err)
           }
        })
     }) 
    } )
    
    // $ ( function () {
    // if ( getLoc ) {
              
    // }
    // })

</script>